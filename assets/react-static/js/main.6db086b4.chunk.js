(this.webpackJsonptweetme_reactjs=this.webpackJsonptweetme_reactjs||[]).push([[0],{13:function(e,t,n){},14:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(5),o=n.n(c),l=(n(13),n(2)),i=n(1);var s=function(e,t,n,a){var r=new XMLHttpRequest,c="http://localhost:8000/api".concat(t);console.log(c),r.responseType="json",r.open(e,c),r.setRequestHeader("Content-Type","application/json");var o,l=function(e){var t=null;if(document.cookie&&""!==document.cookie)for(var n=document.cookie.split(";"),a=0;a<n.length;a++){var r=n[a].trim();if(r.substring(0,e.length+1)===e+"="){t=decodeURIComponent(r.substring(e.length+1));break}}return t}("csrftoken");l&&r.setRequestHeader("X-CSRFToken",l),"POST"===e&&r.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.onload=function(){403===r.status&&r.response&&("Authentication credentials were not provided."===r.response.detail&&-1===window.location.href.indexOf("login")&&(window.location.href="account/login?showLoginRequired=true"));n(r.response,r.status)},r.onerror=function(e){console.log("error",e),n({msg:"error on request"},400)},a&&(o=JSON.stringify(a)),r.send(o)},u=function(e,t){var n="/feed/";null!==t&&void 0!==t&&(n=t.replace("http://localhost:8000/api","")),s("GET",n,e)},m=function(e){var t=r.a.createRef(),n=e.didTweet,a=function(e,t){201===t?n(e):console.log(t,e)};return r.a.createElement("div",{className:"col-8 my-4"},r.a.createElement("form",{action:"",onSubmit:function(e){e.preventDefault();var n=t.current.value;s("POST","/create/",a,{content:n}),t.current.value=""}},r.a.createElement("textarea",{required:!0,ref:t,className:"form-control",placeholder:"tweet it..."}),r.a.createElement("button",{type:"submit",className:"btn btn-secondary mt-2"},"tweet")))},d=function(e){var t=e.newTweets,n=Object(a.useState)([]),c=Object(i.a)(n,2),o=c[0],s=c[1],m=Object(a.useState)([]),d=Object(i.a)(m,2),f=d[0],p=d[1],b=Object(a.useState)(!1),w=Object(i.a)(b,2),v=w[0],E=w[1],h=Object(a.useState)(null),y=Object(i.a)(h,2),j=y[0],O=y[1];Object(a.useEffect)((function(){var e=Object(l.a)(t).concat(o);e.length!==f.length&&(p(e),console.log("final tweets Updated"))}),[t,o,f]),Object(a.useEffect)((function(){if(!1===v){console.log("tweetsLoadApi called");u((function(e,t){200===t?(s(e.results),O(e.next),E(!0)):console.log("There is an error;probably the django server is not running")}))}}),[o,v,E,e.username]);var k=function(e){var t=Object(l.a)(o);t.unshift(e),s(t);var n=Object(l.a)(f);n.unshift(e),s(n)};return r.a.createElement(r.a.Fragment,null," ",r.a.createElement("div",null,f.map((function(e,t){return r.a.createElement(g,{key:t,didRetweet:k,tweet:e})}))),null!=j&&r.a.createElement("button",{className:"btn btn-primary",onClick:function(e){if(e.preventDefault(),null!=j){u((function(e,t){if(200===t){var n=e.results,a=Object(l.a)(f).concat(n);p(a),s(a),O(e.next)}else console.log("There is an error;probably the django server is not running")}),j)}}},"Load More"))},f=function(e){var t=e.tweet,n=e.action,a=e.didPerformAction,c=t.likes?t.likes:0,o="btn btn-primary mt-2 mx-2";"retweet"===n.type&&(o="btn mt-2 mx-2 btn-outline-info");var l=n.display?n.display:"action",i=function(e,t){console.log(e,t),200!==t&&201!==t||!a||a(e,t)},u="like"===n.type?"".concat(c," ").concat(l):l;return r.a.createElement("button",{className:o,onClick:function(e){var a,r;e.preventDefault(),a=t.id,r=n.type,s("POST","/action",i,{id:a,action:r})}},u)},p=n(7),b=function(e){var t=e.user;return r.a.createElement(w,{user:t},r.a.createElement("span",{className:"px-4 py-2 rounded-circle border text-center bg-secondary",style:{fontSize:"40px"}},t.username[0]))},w=function(e){var t=e.user;return r.a.createElement("span",{className:"pointer",onClick:function(e){window.location.pathname="/profile/".concat(t.username)}},e.children)},v=function(e){var t=e.user,n=e.includeFullName;console.log(n);var a=!0===n?"".concat(t.first_name," ").concat(t.last_name):null;return console.log(a),r.a.createElement(r.a.Fragment,null,a," ",r.a.createElement(w,{user:t},"@",t.username))},E=function(e){var t=e.tweet,n=e.retweeter;return t.parent?r.a.createElement("div",{className:"bg-secondary"},r.a.createElement("p",{className:"px-2"},"retweet via ",r.a.createElement(v,{user:n})),r.a.createElement(g,{hideActions:!0,tweet:t.parent})):null},g=function(e){var t=e.tweet,n=e.didRetweet,c=e.hideActions,o=window.location.pathname,l=Object(p.a)(/([0-9]+)/,{tweetId:1}),s=o.match(l),u=s?s.groups.tweetId:-1,m="".concat(t.id)==="".concat(u),d=Object(a.useState)(t||null),w=Object(i.a)(d,2),g=w[0],h=w[1],y=function(e,t){200===t?h(e):201===t&&n&&(n(e),console.log("retweeted"))};return r.a.createElement("div",{className:"card mx-4 my-2"},r.a.createElement("div",{className:"card-body d-flex"},r.a.createElement("div",{className:"col-1"},r.a.createElement(b,{user:t.user})),r.a.createElement("div",{className:"col-11"},r.a.createElement("div",null,r.a.createElement("p",{className:"pl-2 mx-2 text text-dark bg-white"},r.a.createElement(v,{user:t.user,includeFullName:!0})),r.a.createElement("p",{className:"py-2 my-2 text text-dark bg-white border text-center"},t.content),r.a.createElement(E,{tweet:t,retweeter:t.user})),g&&!0!==c&&r.a.createElement(r.a.Fragment,null,r.a.createElement(f,{tweet:g,didPerformAction:y,action:{type:"like",display:"Likes"}}),r.a.createElement(f,{tweet:g,didPerformAction:y,action:{type:"unlike",display:"Unlike"}}),r.a.createElement(f,{tweet:g,didPerformAction:y,action:{type:"retweet",display:"Retweet"}})),!0===m?null:r.a.createElement("button",{className:"btn btn-secondary",onClick:function(e){e.preventDefault(),window.location.href="/".concat(t.id)}}," View"))))},h=function(e){var t=Object(a.useState)([]),n=Object(i.a)(t,2),c=n[0],o=n[1],s="false"!==e.canTweet;return r.a.createElement("div",null,!0===s&&r.a.createElement(m,{didTweet:function(e){var t=Object(l.a)(c);t.unshift(e),o(t)},className:"mx-2 my-4"}),r.a.createElement(d,Object.assign({newTweets:c},e)))},y=function(e){var t=e.tweetid;console.log(t);var n=Object(a.useState)(!1),c=Object(i.a)(n,2),o=c[0],l=c[1],u=Object(a.useState)(null),m=Object(i.a)(u,2),d=m[0],f=m[1],p=function(e,t){200===t?f(e):alert("There was an error finding your tweet")};return Object(a.useEffect)((function(){var e;console.log("use effect called"),!1===o&&(e=p,s("GET","/".concat(t),e),l(!0))}),[t,o,l]),null===d?null:r.a.createElement(g,{tweet:d})},j=document.getElementById("tweetme-2"),O=r.a.createElement;if(j){console.log(j.dataset);var k=O(h,j.dataset);o.a.render(k,j)}var x=document.getElementById("tweetme-feed");if(x){var N=O(h);o.a.render(N,x)}document.querySelectorAll(".tweetme-detail").forEach((function(e){o.a.render(O(y,e.dataset),e)}))},8:function(e,t,n){e.exports=n(14)}},[[8,1,2]]]);
//# sourceMappingURL=main.6db086b4.chunk.js.map